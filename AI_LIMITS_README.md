# –°–∏—Å—Ç–µ–º–∞ –ª–∏–º–∏—Ç–æ–≤ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–π

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `ai_generations` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `generation_date` - –¥–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (—Ñ–æ—Ä–º–∞—Ç YYYY-MM-DD)
- `count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –∑–∞ –¥–µ–Ω—å

### 2. –§—É–Ω–∫—Ü–∏–∏ –≤ database.py

#### `check_ai_generation_limit(user_id, daily_limit=2)`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `(–º–æ–∂–Ω–æ_–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å: bool, –æ—Å—Ç–∞–≤—à–∏–µ—Å—è_–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: int)`
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: 
  - –ê–¥–º–∏–Ω—ã –∏–º–µ—é—Ç –±–µ–∑–ª–∏–º–∏—Ç (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True, 999`)
  - –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã 2 –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–º–∏ –≤ –¥–µ–Ω—å

#### `increment_ai_generation(user_id)`
–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `bool` (—É—Å–ø–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–∏)
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç

#### `get_ai_generation_stats(user_id)`
–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `Dict` —Å –∫–ª—é—á–∞–º–∏:
  - `today` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Å–µ–≥–æ–¥–Ω—è
  - `total` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
  - `is_admin` - —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–æ–º

### 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ ai_assistant.py

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
–í —Ñ—É–Ω–∫—Ü–∏–∏ `get_ai_response()` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```python
can_generate, remaining = database.check_ai_generation_limit(user_id, daily_limit=2)
is_admin = database.is_admin(user_id)
```

#### –í–µ—Å–µ–ª—ã–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å—á–µ—Ä–ø–∞–ª –ª–∏–º–∏—Ç, –≤–º–µ—Å—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–¥–∏–Ω –∏–∑ –≤–µ—Å–µ–ª—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤:
- ü§ñ "–ë–∏–ø-–±—É–ø! –ú–æ–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –±–∞—Ç–∞—Ä–µ–π–∫–∏ —Å–µ–ª–∏..."
- üé® "–£–ø—Å! –ú–æ–π —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ª–∏–º–∏—Ç –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –∏—Å—á–µ—Ä–ø–∞–Ω..."
- üò¥ "–ú–æ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ö—É–¥–æ–∂–Ω–∏–∫ —É—Å—Ç–∞–ª –∏ –ª–µ–≥ —Å–ø–∞—Ç—å..."
- üéâ "–í–∞—É! –í—ã —Ç–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤—Å–µ 2 –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏!..."
- üßô‚Äç‚ôÇÔ∏è "–û–π, –∫–∞–∂–µ—Ç—Å—è –º–æ—è –≤–æ–ª—à–µ–±–Ω–∞—è –ø–∞–ª–æ—á–∫–∞ —Ä–∞–∑—Ä—è–¥–∏–ª–∞—Å—å!..."

#### –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ-–∞–¥–º–∏–Ω–æ–≤:
```python
if not is_admin:
    database.increment_ai_generation(user_id)
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü–æ–∫–∞–∂–∏ –î–µ–¥–ø—É–ª–∞")
2. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏–º–∏—Ç (2 –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –¥–µ–Ω—å)
3. –ï—Å–ª–∏ –ª–∏–º–∏—Ç –Ω–µ –∏—Å—á–µ—Ä–ø–∞–Ω:
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - –°—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
4. –ï—Å–ª–∏ –ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –≤–µ—Å–µ–ª—ã–π –æ—Ç–≤–µ—Ç –æ —Ç–æ–º, —á—Ç–æ –ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω
   - –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å—Å—è –∑–∞–≤—Ç—Ä–∞

### –î–ª—è –∞–¥–º–∏–Ω–æ–≤:
- –ê–¥–º–∏–Ω—ã –∏–º–µ—é—Ç –±–µ–∑–ª–∏–º–∏—Ç –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –°—á–µ—Ç—á–∏–∫ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –ù–ï —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True, 999`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
python test_ai_limits.py
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (2 –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)
- –ü–µ—Ä–≤—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (–æ—Å—Ç–∞–µ—Ç—Å—è 1)
- –í—Ç–æ—Ä—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é (–æ—Å—Ç–∞–µ—Ç—Å—è 0)
- –ü–æ–ø—ã—Ç–∫—É —Ç—Ä–µ—Ç—å–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è)
- –ë–µ–∑–ª–∏–º–∏—Ç –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

## –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `ai_generations` –Ω–µ —Å–æ–∑–¥–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
python init_ai_limits.py
```

## –°–±—Ä–æ—Å –ª–∏–º–∏—Ç–æ–≤

–õ–∏–º–∏—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å (–ø–æ –¥–∞—Ç–µ).
–î–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL:
```sql
DELETE FROM ai_generations WHERE generation_date < date('now');
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –õ–∏–º–∏—Ç –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (GEN_IMAGE)
- –û–±—ã—á–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã AI –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã
- –ü–æ–∏—Å–∫ –±–ª—é–¥ —Å —Ñ–æ—Ç–æ (DISH_PHOTO) –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω
- –ê–¥–º–∏–Ω—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É `admins`
