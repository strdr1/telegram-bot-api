#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Ç–µ—Å—Ç AI —Å–∏—Å—Ç–µ–º—ã - –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
"""

import asyncio
import sys
import os

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

from ai_assistant import get_ai_response

async def test_real_scenario():
    """–¢–µ—Å—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    print("üéØ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...\n")
    
    # –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í–æ–ø—Ä–æ—Å –æ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ –ø–∏—Ü—Ü—ã -> "–•–æ—á—É"
    print("=== –°–¶–ï–ù–ê–†–ò–ô 1: –ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –ø–∏—Ü—Ü—ã ===")
    print("üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: '–ö–∞–∫–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å —É –ø–∏—Ü—Ü—ã?'")
    result1 = await get_ai_response("–ö–∞–∫–∞—è –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å —É –ø–∏—Ü—Ü—ã?", 999999999)
    print(f"ü§ñ AI: {result1.get('text', '–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞')}")
    print()
    
    print("üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: '–•–æ—á—É'")
    result2 = await get_ai_response("–•–æ—á—É", 999999999)
    print(f"ü§ñ AI: {result2.get('text', '–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞')[:200]}...")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–∫–∞–∑–∞–ª –ª–∏ AI —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü
    if '–ø–∏—Ü—Ü' in result2.get('text', '').lower() and '‚ÇΩ' in result2.get('text', ''):
        print("‚úÖ –£–°–ü–ï–•: AI –ø–æ–∫–∞–∑–∞–ª —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü —Å —Ü–µ–Ω–∞–º–∏!")
        scenario1_success = True
    else:
        print("‚ùå –û–®–ò–ë–ö–ê: AI –ù–ï –ø–æ–∫–∞–∑–∞–ª —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü")
        scenario1_success = False
    
    print("\n" + "="*50 + "\n")
    
    # –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü—Ä—è–º–æ–π –≤–æ–ø—Ä–æ—Å –æ –ø–∏—Ü—Ü–µ
    print("=== –°–¶–ï–ù–ê–†–ò–ô 2: –ü—Ä—è–º–æ–π –≤–æ–ø—Ä–æ—Å –æ –ø–∏—Ü—Ü–µ ===")
    print("üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: '–£ –≤–∞—Å –µ—Å—Ç—å –ø–∏—Ü—Ü–∞?'")
    result3 = await get_ai_response("–£ –≤–∞—Å –µ—Å—Ç—å –ø–∏—Ü—Ü–∞?", 999999999)
    print(f"ü§ñ AI: {result3.get('text', '–ù–µ—Ç —Ç–µ–∫—Å—Ç–∞')[:200]}...")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–∫–∞–∑–∞–ª –ª–∏ AI —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü
    if '–ø–∏—Ü—Ü' in result3.get('text', '').lower() and '‚ÇΩ' in result3.get('text', ''):
        print("‚úÖ –£–°–ü–ï–•: AI –ø–æ–∫–∞–∑–∞–ª —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü —Å —Ü–µ–Ω–∞–º–∏!")
        scenario2_success = True
    else:
        print("‚ùå –û–®–ò–ë–ö–ê: AI –ù–ï –ø–æ–∫–∞–∑–∞–ª —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü")
        scenario2_success = False
    
    print("\n" + "="*50 + "\n")
    
    # –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –±–ª—é–¥–æ
    print("=== –°–¶–ï–ù–ê–†–ò–ô 3: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –±–ª—é–¥–æ ===")
    print("üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: '–ü–∏—Ü—Ü–∞ 4 —Å—ã—Ä–∞'")
    result4 = await get_ai_response("–ü–∏—Ü—Ü–∞ 4 —Å—ã—Ä–∞", 999999999)
    print(f"ü§ñ AI: –¢–∏–ø –æ—Ç–≤–µ—Ç–∞: {result4.get('type')}")
    if result4.get('type') == 'photo_with_text':
        print(f"üì∏ –§–æ—Ç–æ: {result4.get('photo_url')}")
        print(f"üìù –û–ø–∏—Å–∞–Ω–∏–µ: {result4.get('text', '')[:100]}...")
        print("‚úÖ –£–°–ü–ï–•: AI –ø–æ–∫–∞–∑–∞–ª —Ñ–æ—Ç–æ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –±–ª—é–¥–∞!")
        scenario3_success = True
    else:
        print("‚ùå –û–®–ò–ë–ö–ê: AI –ù–ï –ø–æ–∫–∞–∑–∞–ª —Ñ–æ—Ç–æ –±–ª—é–¥–∞")
        scenario3_success = False
    
    print("\n" + "="*50 + "\n")
    
    # –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    total_success = scenario1_success and scenario2_success and scenario3_success
    
    print("üìä –ò–¢–û–ì–û–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:")
    print(f"–°—Ü–µ–Ω–∞—Ä–∏–π 1 (–ö–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å -> –•–æ—á—É): {'‚úÖ –£–°–ü–ï–•' if scenario1_success else '‚ùå –û–®–ò–ë–ö–ê'}")
    print(f"–°—Ü–µ–Ω–∞—Ä–∏–π 2 (–£ –≤–∞—Å –µ—Å—Ç—å –ø–∏—Ü—Ü–∞?): {'‚úÖ –£–°–ü–ï–•' if scenario2_success else '‚ùå –û–®–ò–ë–ö–ê'}")
    print(f"–°—Ü–µ–Ω–∞—Ä–∏–π 3 (–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –±–ª—é–¥–æ): {'‚úÖ –£–°–ü–ï–•' if scenario3_success else '‚ùå –û–®–ò–ë–ö–ê'}")
    print()
    
    if total_success:
        print("üéâ –í–°–ï –°–¶–ï–ù–ê–†–ò–ò –†–ê–ë–û–¢–ê–Æ–¢ –ö–û–†–†–ï–ö–¢–ù–û!")
        print("–ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –†–ï–®–ï–ù–ê! ‚úÖ")
    else:
        print("‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö")
    
    return total_success

async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è AI —Å–∏—Å—Ç–µ–º—ã...\n")
    
    success = await test_real_scenario()
    
    print(f"\nüèÅ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:")
    if success:
        print("üéâ AI –°–ò–°–¢–ï–ú–ê –†–ê–ë–û–¢–ê–ï–¢ –ü–†–ê–í–ò–õ–¨–ù–û!")
        print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —Å–ø–∏—Å–æ–∫ –ø–∏—Ü—Ü –∫–æ–≥–¥–∞ —Å–∫–∞–∂–µ—Ç '–•–æ—á—É' –ø–æ—Å–ª–µ –≤–æ–ø—Ä–æ—Å–∞ –æ –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏!")
    else:
        print("üí• –¢—Ä–µ–±—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è")

if __name__ == "__main__":
    asyncio.run(main())